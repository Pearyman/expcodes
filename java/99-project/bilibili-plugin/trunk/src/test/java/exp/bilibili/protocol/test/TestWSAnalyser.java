package exp.bilibili.protocol.test;

import exp.bilibili.plugin.Config;
import exp.libs.utils.encode.CharsetUtils;
import exp.libs.utils.num.BODHUtils;
import exp.libs.utils.other.StrUtils;

public class TestWSAnalyser {

	public static void main(String[] args) {
		String hex = "000001100010000000000005000000007B22696E666F223A5B5B302C312C32352C31363737373231352C313531383335353234352C2231353138333533383233222C302C223366626662386364222C305D2C22E4B889E5B9B4E58AA8E794BBE6B2A1E799BDE5ADA6222C5B36343330312C22E5B9BBE58991E697A0E58F8C222C302C302C302C31303030302C312C22225D2C5B332C22E79CA0E998B3222C22E79DA1E4B88DE98692E79A84E69F90E69F90E998B3222C22353434383933222C363430363233342C22225D2C5B32332C302C353830353739302C223E3530303030225D2C5B5D2C302C302C7B22756E616D655F636F6C6F72223A22227D5D2C22636D64223A2244414E4D555F4D5347227D0000012A0010000000000005000000007B22696E666F223A5B5B302C312C32352C31363737373231352C313531383335353234362C2231353138333532373430222C302C223162643334313435222C305D2C22E8BF99E6AF94E8AEB8E4BB99E58FAFE8A681E58E89E5AEB3E5A49AE4BA86222C5B33383239373636362C22E99BA8E6B49BE4B9A6222C302C312C302C31303030302C312C22225D2C5B31302C22E7BF98E69D8EE59097222C22E88B8FE4B9946F5F6F222C3433382C31303531323632352C22225D2C5B32332C302C353830353739302C223E3530303030225D2C5B227369676E2D6F6E652D6D6F6E7468222C227469746C652D31372D31225D2C302C302C7B22756E616D655F636F6C6F72223A22227D5D2C22636D64223A2244414E4D555F4D5347227D";
		alalyseMsg(hex);
	}
	
	public static void alalyseMsg(String hexMsg) {
		byte[] bytes = BODHUtils.toBytes(hexMsg);
		String msg = new String(bytes);
		System.out.println(StrUtils.view(msg));
		System.out.println("====");
		
		String split = hexMsg.substring(0, 32);	// 消息的前32个字节(即16个字符)为分隔符
		String[] hexs = hexMsg.split(split);
		for(String hex : hexs) {
			if(StrUtils.isEmpty(hex)) {
				continue;
			}
			
			msg = CharsetUtils.toStr(BODHUtils.toBytes(hex), Config.DEFAULT_CHARSET);
			System.out.println(msg);
		}
	}
	
}
